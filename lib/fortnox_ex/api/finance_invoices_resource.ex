# NOTE: This file is auto generated by OpenAPI Generator 6.6.0 (https://openapi-generator.tech).
# Do not edit this file manually.

defmodule FortnoxEx.Api.FinanceInvoicesResource do
  @moduledoc """
  API calls for all endpoints tagged `FinanceInvoicesResource`.
  """

  alias FortnoxEx.Connection
  import FortnoxEx.RequestBuilder

  @doc """
  Send an invoice with Fortnox Finans
  <p>  When sending an invoice with Fortnox Finans you will get the invoice status returned if everything succeeded,  if there were any problems, an error will be returned.  <p>  Please note that it can take 1 min to several hours before you will get back status, OCR number and link to  PDF document, meanwhile the invoice will have status UNKNOWN or NOT_AUTHORIZED.  <p>  Fortnox Finans is currently only accepting invoices in SEK  <p>  <i>Parameters in the body:</i>  <ul>      <li><b>InvoiceNumber</b>: the invoice number for the invoice which should be sent with Fortnox Finans</li>      <li><b>SendMethod</b>: how to send the invoice; EMAIL, LETTER, EINVOICE or NONE</li>      <li><b>Service</b>: which service to use; LEDGERBASE or REMINDER</li>  </ul>  <p>

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `opts` (keyword): Optional parameters
    - `:body` (CreatePayloadWrap): The payload for sending an invoice with  Fortnox Finans

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec create_finance_invoices_resource(Tesla.Env.client, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def create_finance_invoices_resource(connection, opts \\ []) do
    optional_params = %{
      :body => :body
    }

    request =
      %{}
      |> method(:post)
      |> url("/noxfinansinvoices/")
      |> add_optional_params(optional_params, opts)
      |> ensure_body()
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end

  @doc """
  Retrieve a single invoice payment
  <p>  Retrieves the status and balance of an invoice sent to Fortnox Finans.  You need to supply the invoice number in Fortox to retrieve the invoice.  <p>  <b>Note that</b> invoices sent with the old &quot;Noxbox&quot; platform will not have the &quot;ServiceName&quot;  property in the response. This new property is added to the response if the invoice is  sent with the new finance service.  <p>  Response explanation for <b>Service</b> and <b>ServiceName</b>  <p>  <b>Service:</b>  <ul>      <li><b>LEDGERBASE</b>: if the invoice is sent by using the old &quot;Noxbox&quot; platform, or the new finance service with the subtypes &quot;Service Full&quot; or &quot;Service Light&quot;. These services are explained above in the &quot;Fortnox Finans services&quot; section</li>      <li><b>REMINDER</b>: If the invoice is sent by the new finance service, with the service Reminder Service</li>  </ul>  <p>  <b>ServiceName</b> (only provided for <u>new finance service</u> invoices):  <ul>      <li><b>SERVICE_FULL</b>: Ledgerbase service <u>with</u> automatic reminders is used</li>      <li><b>SERVICE_LIGHT</b>: Ledgerbase service <u>without</u> automatic reminders is used.</li>      <li><b>REMINDER_SERVICE</b>: Reminder service is used</li>  </ul>

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `number` (String.t): The Fortnox invoice number
  - `opts` (keyword): Optional parameters

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec get_finance_invoices_resource(Tesla.Env.client, String.t, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def get_finance_invoices_resource(connection, number, _opts \\ []) do
    request =
      %{}
      |> method(:get)
      |> url("/noxfinansinvoices/#{number}")
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end

  @doc """
  Action Pause
  <p>  Pauses an invoice for up to 60 days. Pause means that Fortnox Finans reminder process will stop for the invoice. All invoices which have the status OPEN can be paused.  <p>  <i>Parameters in the body:</i>  <ul>      <li><b>PausedUntilDate</b>: the invoice will be paused to and including this date.</li>  </ul>  <p>

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `number` (String.t): The Fortnox invoice number
  - `opts` (keyword): Optional parameters
    - `:body` (PausePayloadWrap): The payload for sending an invoice with  Fortnox Finans

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec pause(Tesla.Env.client, String.t, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def pause(connection, number, opts \\ []) do
    optional_params = %{
      :body => :body
    }

    request =
      %{}
      |> method(:put)
      |> url("/noxfinansinvoices/#{number}/pause")
      |> add_optional_params(optional_params, opts)
      |> ensure_body()
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end

  @doc """
  Action Report Payment
  <p>  If a customer has paid some or all of the capital on an invoice directly to the client, this can be reported  for bookkeeping purposes and reported to Fortnox Finans to actually deduct the paid amount from the invoice.  <p>  <b>Note:</b> this action is <b>not</b> available for invoices sent by the old Noxbox platform  <p>  <i>Parameters in the body:</i>  <ul>      <li><b>ClientTakesFees</b>: a boolean indicating if the client should take the customer fees or not.</li>      <li><b>BookkeepPaymentInFortnox</b>: a boolean indicating if the payment should be bookkept in Fortnox or not. Usually the payment should be bookkept.</li>      <li><b>ReportToFinance</b>: a boolean indicating if the payment should be reported to Fortnox Finans or not. Usually the payment should be reported.</li>      <li><b>PaymentAmount</b>: a decimal field with the amount to report.</li>      <li><b>PaymentMethodCode</b>: a string with the method code (e.g. BG, PG or other). Could be omitted if BookkeepPaymentInFortnox is false.</li>      <li><b>PaymentMethodAccount</b>: an integer with the account number to bookkeep the payment on (e.g. 1920 or other). Could be omitted if BookkeepPaymentInFortnox is false.</li>  </ul>  <p>

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `number` (String.t): The Fortnox invoice number
  - `opts` (keyword): Optional parameters
    - `:body` (ReportPaymentPayload): The payload for sending an invoice with  Fortnox Finans

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec report_payment(Tesla.Env.client, String.t, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def report_payment(connection, number, opts \\ []) do
    optional_params = %{
      :body => :body
    }

    request =
      %{}
      |> method(:put)
      |> url("/noxfinansinvoices/#{number}/report-payment")
      |> add_optional_params(optional_params, opts)
      |> ensure_body()
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end

  @doc """
  Action Stop
  <p>  Removes the invoice from Fortnox Finans process. The invoice can still be handled manually, but no further automatic process will be applied  <p>

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `number` (String.t): The Fortnox invoice number
  - `opts` (keyword): Optional parameters

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec stop(Tesla.Env.client, String.t, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def stop(connection, number, _opts \\ []) do
    request =
      %{}
      |> method(:put)
      |> url("/noxfinansinvoices/#{number}/stop")
      |> ensure_body()
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end

  @doc """
  Action Take Fees
  <p>  If fees have been added to an invoice, e.g. reminder fees, the client can choose to pay those fees instead of letting the customer pay.  <p>  <b>Note:</b> this action is <b>not</b> available for invoices sent by the old Noxbox platform

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `number` (String.t): The Fortnox invoice number
  - `opts` (keyword): Optional parameters

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec take_fees(Tesla.Env.client, String.t, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def take_fees(connection, number, _opts \\ []) do
    request =
      %{}
      |> method(:put)
      |> url("/noxfinansinvoices/#{number}/take-fees")
      |> ensure_body()
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end

  @doc """
  Action Unpause
  <p>  Unpauses a paused invoice. If the invoice is manually paused, then this action will remove the pause status immediately. Invoices which are paused by the system cannot be unpaused.  <p>  <b>Note:</b> this action is <b>not</b> available for invoices sent by the old Noxbox platform

  ### Parameters

  - `connection` (FortnoxEx.Connection): Connection to server
  - `number` (String.t): The Fortnox invoice number
  - `opts` (keyword): Optional parameters

  ### Returns

  - `{:ok, FortnoxEx.Model.InvoiceResponseWrap.t}` on success
  - `{:error, Tesla.Env.t}` on failure
  """
  @spec unpause(Tesla.Env.client, String.t, keyword()) :: {:ok, FortnoxEx.Model.InvoiceResponseWrap.t} | {:error, Tesla.Env.t}
  def unpause(connection, number, _opts \\ []) do
    request =
      %{}
      |> method(:put)
      |> url("/noxfinansinvoices/#{number}/unpause")
      |> ensure_body()
      |> Enum.into([])

    connection
    |> Connection.request(request)
    |> evaluate_response([
      {200, %FortnoxEx.Model.InvoiceResponseWrap{}}
    ])
  end
end
